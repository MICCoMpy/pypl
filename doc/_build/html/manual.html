<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Manual &mdash; PyPL 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Credits" href="acknowledge.html" />
    <link rel="prev" title="Tutorials" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyPL
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pypl.hrsolver">HR solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pypl.hrsolver.HRsolver"><code class="docutils literal notranslate"><span class="pre">HRsolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrsolver.HRsolver.compute_spectral_density"><code class="docutils literal notranslate"><span class="pre">HRsolver.compute_spectral_density()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrsolver.HRsolver.compute_lineshape_numerical_integration"><code class="docutils literal notranslate"><span class="pre">HRsolver.compute_lineshape_numerical_integration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrsolver.HRsolver.compute_lineshape_fft"><code class="docutils literal notranslate"><span class="pre">HRsolver.compute_lineshape_fft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrsolver.HRsolver.compute_spectrum"><code class="docutils literal notranslate"><span class="pre">HRsolver.compute_spectrum()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pypl.lineshape">Line shape</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pypl.lineshape.lineshape"><code class="docutils literal notranslate"><span class="pre">lineshape</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pypl.lineshape.lineshape.f_sigma"><code class="docutils literal notranslate"><span class="pre">lineshape.f_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.lineshape.lineshape.compute_lineshape_numerical_integration"><code class="docutils literal notranslate"><span class="pre">lineshape.compute_lineshape_numerical_integration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.lineshape.lineshape.compute_lineshape_fft"><code class="docutils literal notranslate"><span class="pre">lineshape.compute_lineshape_fft()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pypl.hrf">Huang-Rhys factors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pypl.hrf.hrf"><code class="docutils literal notranslate"><span class="pre">hrf</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrf.hrf.set_masses"><code class="docutils literal notranslate"><span class="pre">hrf.set_masses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrf.hrf.compute_hrf_forces"><code class="docutils literal notranslate"><span class="pre">hrf.compute_hrf_forces()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrf.hrf.compute_hrf_dis"><code class="docutils literal notranslate"><span class="pre">hrf.compute_hrf_dis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrf.hrf.gaussian"><code class="docutils literal notranslate"><span class="pre">hrf.gaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrf.hrf.f_sigma"><code class="docutils literal notranslate"><span class="pre">hrf.f_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypl.hrf.hrf.compute_spectral_density"><code class="docutils literal notranslate"><span class="pre">hrf.compute_spectral_density()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pypl.utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pypl.utils.parse_atoms_qexml"><code class="docutils literal notranslate"><span class="pre">parse_atoms_qexml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pypl.utils.parse_forces_qexml"><code class="docutils literal notranslate"><span class="pre">parse_forces_qexml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pypl.utils.parse_phonopy_h5"><code class="docutils literal notranslate"><span class="pre">parse_phonopy_h5()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pypl.utils.parse_phonopy_yaml"><code class="docutils literal notranslate"><span class="pre">parse_phonopy_yaml()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="acknowledge.html">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyPL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Manual</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/manual.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="manual">
<span id="id1"></span><h1>Manual<a class="headerlink" href="#manual" title="Link to this heading"></a></h1>
<p>The complete <strong>PyPL</strong> reference is reported below.</p>
<section id="module-pypl.hrsolver">
<span id="hr-solver"></span><h2>HR solver<a class="headerlink" href="#module-pypl.hrsolver" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pypl.hrsolver.HRsolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypl.hrsolver.</span></span><span class="sig-name descname"><span class="pre">HRsolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonopy_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">es_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrsolver.html#HRsolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrsolver.HRsolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>High-level solver for computing Huang–Rhys factors (HRFs), spectral density,
and optical lineshapes from phonon and structural data.</p>
<p>Depending on the inputs, HRFs are computed using either forces or displacements:</p>
<ul class="simple">
<li><p>Provide only <code class="docutils literal notranslate"><span class="pre">forces_file</span></code> for force-based HRFs.</p></li>
<li><p>Provide both <code class="docutils literal notranslate"><span class="pre">gs_file</span></code> and <code class="docutils literal notranslate"><span class="pre">es_file</span></code> for displacement-based HRFs.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phonopy_file</strong> (<em>str</em>) – Path to Phonopy HDF5 file with phonon frequencies and eigenmodes.</p></li>
<li><p><strong>forces_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to QE XML file with atomic forces.</p></li>
<li><p><strong>gs_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to QE XML file with ground-state coordinates.</p></li>
<li><p><strong>es_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to QE XML file with excited-state coordinates.</p></li>
<li><p><strong>mass_list</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping element symbols to atomic masses (in atomic units).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input combination is invalid (e.g. mixing force and displacement inputs).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrsolver.HRsolver.compute_spectral_density">
<span class="sig-name descname"><span class="pre">compute_spectral_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectral_density_energy_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[6,</span> <span class="pre">1.5]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrsolver.html#HRsolver.compute_spectral_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrsolver.HRsolver.compute_spectral_density" title="Link to this definition"></a></dt>
<dd><p>Compute the phonon spectral density.</p>
<div class="math notranslate nohighlight">
\[S(\hbar \omega) = \sum_k S_k G(\hbar \omega, \hbar \omega_k, \sigma(\omega_k))\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is a normalized Gaussian centered at each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectral_density_energy_axis</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Energy axis (in meV). Defaults to <code class="docutils literal notranslate"><span class="pre">np.linspace(0,</span> <span class="pre">200,</span> <span class="pre">2001)</span></code>
(0–200 meV in 0.1 meV steps).</p></li>
<li><p><strong>sigma</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Two-element list <code class="docutils literal notranslate"><span class="pre">[sigma_min,</span> <span class="pre">sigma_max]</span></code> in meV for linewidth
interpolation. Default is [6, 1.5].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>energy_axis</strong> (<em>ndarray</em>) – Energy axis in meV.</p></li>
<li><p><strong>spectral_density</strong> (<em>ndarray</em>) – Computed spectral density (in 1/meV).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrsolver.HRsolver.compute_lineshape_numerical_integration">
<span class="sig-name descname"><span class="pre">compute_lineshape_numerical_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[6,</span> <span class="pre">1.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpl_broadening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">20000]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineshape_energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-150,</span> <span class="pre">550]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineshape_energy_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">701</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrsolver.html#HRsolver.compute_lineshape_numerical_integration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrsolver.HRsolver.compute_lineshape_numerical_integration" title="Link to this definition"></a></dt>
<dd><p>Compute the temperature-dependent optical lineshape via direct time-domain integration.</p>
<div class="math notranslate nohighlight">
\[A(\hbar \omega, T) = \int dt \left(i \omega t - \frac{|t| \gamma_\mathrm{ZPL}}{\hbar} \right) G(t, T)\]</div>
<p>where <span class="math notranslate nohighlight">\(G(t, T)\)</span> is the generating function including phonon broadening.`gamma_mathrm{ZPL}` is the
zero-phonon line (ZPL) broadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature in Kelvin. Default is 4.</p></li>
<li><p><strong>sigma</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Linewidth interpolation values <code class="docutils literal notranslate"><span class="pre">[sigma_min,</span> <span class="pre">sigma_max]</span></code> in meV.
Default is [6, 1.5].</p></li>
<li><p><strong>zpl_broadening</strong> (<em>float</em><em>, </em><em>optional</em>) – Additional Lorentzian broadening for the ZPL in meV. Default is 0.3.</p></li>
<li><p><strong>time_range</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Time domain [start, end] in femtoseconds. Default is [0, 20000].</p></li>
<li><p><strong>time_resolution</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of time points. Default is 200001.</p></li>
<li><p><strong>lineshape_energy_range</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Energy range [start, end] in meV. Default is [-150, 550].</p></li>
<li><p><strong>lineshape_energy_resolution</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the energy axis. Default is 701.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The result is stored in <code class="docutils literal notranslate"><span class="pre">self.lineshape</span></code> as a tuple
<code class="docutils literal notranslate"><span class="pre">(energy_axis,</span> <span class="pre">A(E))</span></code> where <code class="docutils literal notranslate"><span class="pre">energy_axis</span></code> is in meV and
<code class="docutils literal notranslate"><span class="pre">A(E)</span></code> is the computed lineshape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrsolver.HRsolver.compute_lineshape_fft">
<span class="sig-name descname"><span class="pre">compute_lineshape_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[6,</span> <span class="pre">1.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpl_broadening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineshape_energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1000,</span> <span class="pre">1000]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineshape_energy_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrsolver.html#HRsolver.compute_lineshape_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrsolver.HRsolver.compute_lineshape_fft" title="Link to this definition"></a></dt>
<dd><p>Compute the temperature-dependent optical lineshape
using FFT of the time-domain correlation function.</p>
<div class="math notranslate nohighlight">
\[A(\hbar\omega) = \frac{1}{2\pi\hbar} \!\int dt \exp \left(i \omega t - \frac{|t| \gamma_\mathrm{ZPL}}{\hbar} \right) G(t),\]</div>
<p>where <span class="math notranslate nohighlight">\(G(t, T)\)</span> is the generating function with phonon broadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature in Kelvin. Default is 4.</p></li>
<li><p><strong>sigma</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Linewidth interpolation values <code class="docutils literal notranslate"><span class="pre">[sigma_min,</span> <span class="pre">sigma_max]</span></code> in meV.
Default is [6, 1.5].</p></li>
<li><p><strong>zpl_broadening</strong> (<em>float</em><em>, </em><em>optional</em>) – Lorentzian broadening for the ZPL in meV. Default is 0.3.</p></li>
<li><p><strong>lineshape_energy_range</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Symmetric energy range [start, end] in meV.
Must satisfy <code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">=</span> <span class="pre">-end</span></code>. Default is [-1000, 1000].</p></li>
<li><p><strong>lineshape_energy_resolution</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the energy axis. Default is 2001.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">lineshape_energy_range</span></code> is not symmetric.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The result is stored in <code class="docutils literal notranslate"><span class="pre">self.lineshape</span></code> as a tuple
<code class="docutils literal notranslate"><span class="pre">(energy_axis,</span> <span class="pre">A(E))</span></code> where <code class="docutils literal notranslate"><span class="pre">energy_axis</span></code> is in meV and
<code class="docutils literal notranslate"><span class="pre">A(E)</span></code> is the computed lineshape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrsolver.HRsolver.compute_spectrum">
<span class="sig-name descname"><span class="pre">compute_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ezpl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrsolver.html#HRsolver.compute_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrsolver.HRsolver.compute_spectrum" title="Link to this definition"></a></dt>
<dd><p>Compute the normalized photoluminescence (PL) or absorption spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectrum_type</strong> (<em>str</em>) – Spectrum type:
- “PL”: photoluminescence spectrum
- “Abs”: absorption spectrum</p></li>
<li><p><strong>ezpl</strong> (<em>float</em>) – Zero-phonon line (ZPL) energy in meV.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>energy_axis</strong> (<em>ndarray</em>) – Energy axis in meV.</p></li>
<li><p><strong>spectrum</strong> (<em>ndarray</em>) – Normalized spectral intensity.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pypl.lineshape">
<span id="line-shape"></span><h2>Line shape<a class="headerlink" href="#module-pypl.lineshape" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pypl.lineshape.lineshape">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypl.lineshape.</span></span><span class="sig-name descname"><span class="pre">lineshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hrf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/lineshape.html#lineshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.lineshape.lineshape" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to compute optical lineshapes from Huang-Rhys factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hrf</strong> (<a class="reference internal" href="#pypl.hrf.hrf" title="pypl.hrf.hrf"><em>hrf.hrf</em></a>) – Instance of the <cite>hrf</cite> class containing phonon frequencies and Huang-Rhys factors.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pypl.lineshape.lineshape.f_sigma">
<span class="sig-name descname"><span class="pre">f_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/lineshape.html#lineshape.f_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.lineshape.lineshape.f_sigma" title="Link to this definition"></a></dt>
<dd><p>Compute phonon-dependent broadening parameters.</p>
<p>The broadening is interpolated linearly between two given values
across the range of phonon frequencies:</p>
<div class="math notranslate nohighlight">
\[\sigma(\omega_k) = \sigma_0 - \frac{\sigma_0 - \sigma_1}{\max(\omega_k) - \min(\omega_k)} \, (\omega_k - \min(\omega_k))\]</div>
<p class="rubric">Notes</p>
<p>The computed broadening parameters are stored in the attribute
<code class="docutils literal notranslate"><span class="pre">self.all_sigma</span></code> (ndarray), which contains one value per phonon frequency.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.lineshape.lineshape.compute_lineshape_numerical_integration">
<span class="sig-name descname"><span class="pre">compute_lineshape_numerical_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpl_broadening</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ene_axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/lineshape.html#lineshape.compute_lineshape_numerical_integration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.lineshape.lineshape.compute_lineshape_numerical_integration" title="Link to this definition"></a></dt>
<dd><p>Compute the lineshape function by direct numerical integration.</p>
<p>The lineshape is defined as</p>
<div class="math notranslate nohighlight">
\[A(\hbar\omega, T) = \int dt \, G(t, T) \, e^{i \omega t},\]</div>
<p>where the generating function <span class="math notranslate nohighlight">\(G(t, T)\)</span> is constructed from
Huang-Rhys factors, phonon occupations, and broadening terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em>) – Temperature in Kelvin.</p></li>
<li><p><strong>sigma</strong> (<em>list</em><em> of </em><em>float</em>) – Two-element list <code class="docutils literal notranslate"><span class="pre">[sigma0,</span> <span class="pre">sigma1]</span></code> giving phonon broadening
parameters in meV.</p></li>
<li><p><strong>zpl_broadening</strong> (<em>float</em>) – Zero-phonon line Lorentzian broadening (HWHM) in meV.</p></li>
<li><p><strong>time_axis</strong> (<em>ndarray</em>) – Time axis in femtoseconds.</p></li>
<li><p><strong>ene_axis</strong> (<em>ndarray</em>) – Energy axis in meV.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The computed lineshape is stored in the attribute <code class="docutils literal notranslate"><span class="pre">self.lineshape</span></code>,
a tuple <code class="docutils literal notranslate"><span class="pre">(energy_axis,</span> <span class="pre">A(E))</span></code> where <code class="docutils literal notranslate"><span class="pre">energy_axis</span></code> is in meV
and <code class="docutils literal notranslate"><span class="pre">A(E)</span></code> is the computed lineshape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.lineshape.lineshape.compute_lineshape_fft">
<span class="sig-name descname"><span class="pre">compute_lineshape_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpl_broadening</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/lineshape.html#lineshape.compute_lineshape_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.lineshape.lineshape.compute_lineshape_fft" title="Link to this definition"></a></dt>
<dd><p>Compute the lineshape function by FFT of the time-domain correlation.</p>
<p>The time-domain generating function is</p>
<div class="math notranslate nohighlight">
\[G(t) = \exp \Big[ S(t) - S(0) + 2C(t) - 2C(0) \Big],\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}S(t) &amp;= \sum_k S_k \exp\!\left(-\frac{\sigma_k^2t^2}{2\hbar^2}\right) e^{i \omega_k t}, \\\\
C(t) &amp;= \sum_k n_k S_k \exp\!\left(-\frac{\sigma_k^2t^2}{2\hbar^2}\right) \cos(\omega_k t).\end{split}\]</div>
<p>The frequency-domain lineshape is then obtained as</p>
<div class="math notranslate nohighlight">
\[A(\hbar\omega) = \frac{1}{2\pi\hbar} \!\int dt \exp \left(i \omega t - \frac{|t| \gamma_\mathrm{ZPL}}{\hbar} \right) G(t).\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em>) – Temperature in Kelvin.</p></li>
<li><p><strong>sigma</strong> (<em>list</em><em> of </em><em>float</em>) – Two-element list <code class="docutils literal notranslate"><span class="pre">[sigma0,</span> <span class="pre">sigma1]</span></code> for phonon broadening
parameters (in meV).</p></li>
<li><p><strong>zpl_broadening</strong> (<em>float</em>) – Zero-phonon line Lorentzian broadening (HWHM) in meV.</p></li>
<li><p><strong>energy_axis</strong> (<em>ndarray</em>) – Target energy axis in meV.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The computed lineshape is stored in the attribute <code class="docutils literal notranslate"><span class="pre">self.lineshape</span></code>,
a tuple <code class="docutils literal notranslate"><span class="pre">(energy_axis,</span> <span class="pre">A(E))</span></code> where <code class="docutils literal notranslate"><span class="pre">energy_axis</span></code> is in meV
and <code class="docutils literal notranslate"><span class="pre">A(E)</span></code> is the computed lineshape.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pypl.hrf">
<span id="huang-rhys-factors"></span><h2>Huang-Rhys factors<a class="headerlink" href="#module-pypl.hrf" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pypl.hrf.hrf">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypl.hrf.</span></span><span class="sig-name descname"><span class="pre">hrf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_symbols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrf.html#hrf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrf.hrf" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Compute Huang-Rhys factors and spectral density from phonon
frequencies, eigenmodes, and either forces or displacements.
All inputs, except atomic masses, should be in SI units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freqs</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>3N</em><em>,</em><em>)</em>) – Phonon frequencies in rad/s.</p></li>
<li><p><strong>modes</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>3N</em><em>, </em><em>N</em><em>, </em><em>3</em><em>)</em>) – Phonon eigenmodes.</p></li>
<li><p><strong>atomic_symbols</strong> (<em>list</em><em> of </em><em>str</em>) – Atomic chemical symbols.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrf.hrf.set_masses">
<span class="sig-name descname"><span class="pre">set_masses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrf.html#hrf.set_masses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrf.hrf.set_masses" title="Link to this definition"></a></dt>
<dd><p>Set atomic masses in kilograms for all atoms in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mass_list</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping element symbols to atomic masses in unified atomic
mass units (u). If not provided, IUPAC-recommended values are used.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The converted atomic masses are stored in <code class="docutils literal notranslate"><span class="pre">self.masses</span></code> in kilograms.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrf.hrf.compute_hrf_forces">
<span class="sig-name descname"><span class="pre">compute_hrf_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrf.html#hrf.compute_hrf_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrf.hrf.compute_hrf_forces" title="Link to this definition"></a></dt>
<dd><p>Compute Huang-Rhys factors using atomic forces.</p>
<div class="math notranslate nohighlight">
\[S_k = \frac{\omega_k \Delta Q_k^2}{2 \hbar}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\Delta Q_k = \frac{1}{\omega_k^2} \sum_{\alpha=1}^N \sum_{i=x,y,z} \frac{F_{\alpha i}}{\sqrt{M_\alpha}} e_{k, \alpha i}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>forces</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>N</em><em>, </em><em>3</em><em>)</em>) – Forces on atoms in J/m (SI units).</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The computed Huang-Rhys factors are stored in <code class="docutils literal notranslate"><span class="pre">self.hrf</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrf.hrf.compute_hrf_dis">
<span class="sig-name descname"><span class="pre">compute_hrf_dis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gs_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">es_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrf.html#hrf.compute_hrf_dis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrf.hrf.compute_hrf_dis" title="Link to this definition"></a></dt>
<dd><p>Compute Huang-Rhys factors using atomic displacements.</p>
<div class="math notranslate nohighlight">
\[S_k = \frac{\omega_k \Delta Q_k^2}{2 \hbar}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\Delta Q_k = \sum_{\alpha=1}^N \sum_{i=x,y,z} \sqrt{M_\alpha} \Delta R_{\alpha i} e_{k, \alpha i}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gs_coord</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>N</em><em>, </em><em>3</em><em>)</em>) – Ground-state atomic coordinates (in meters).</p></li>
<li><p><strong>es_coord</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>N</em><em>, </em><em>3</em><em>)</em>) – Excited-state atomic coordinates (in meters).</p></li>
<li><p><strong>cell_parameters</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>3</em><em>, </em><em>3</em><em>)</em>) – Lattice vectors of the simulation cell (in meters).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Displacements are wrapped back into the unit cell.
The computed Huang-Rhys factors are stored in <code class="docutils literal notranslate"><span class="pre">self.hrf</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrf.hrf.gaussian">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrf.html#hrf.gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrf.hrf.gaussian" title="Link to this definition"></a></dt>
<dd><p>Compute the value of a Gaussian function.</p>
<div class="math notranslate nohighlight">
\[G(x) = \frac{1}{\sqrt{2 \pi \sigma^2}} \exp \left(-\frac{(x - \mu)^2}{2 \sigma^2}\right)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Evaluation point.</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – Mean of the Gaussian.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Standard deviation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the Gaussian at <cite>x</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrf.hrf.f_sigma">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">f_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrf.html#hrf.f_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrf.hrf.f_sigma" title="Link to this definition"></a></dt>
<dd><p>Compute a frequency-dependent linewidth function by linear interpolation.</p>
<div class="math notranslate nohighlight">
\[\sigma(\omega_k) = \sigma_0 - \frac{\sigma_0 - \sigma_1}{\max(\omega_k) - \min(\omega_k)} (\omega_k - \min(\omega_k))\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freqs</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>M</em><em>,</em><em>)</em>) – Phonon frequencies in rad/s.</p></li>
<li><p><strong>sigma</strong> (<em>list</em><em> of </em><em>float</em>) – Two-element list <code class="docutils literal notranslate"><span class="pre">[sigma_0,</span> <span class="pre">sigma_1]</span></code> in meV, giving the linewidth
at the minimum and maximum frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>collect_sigma</strong> – Interpolated linewidths <span class="math notranslate nohighlight">\(\sigma(\omega_k)\)</span> in meV.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray of shape (M,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypl.hrf.hrf.compute_spectral_density">
<span class="sig-name descname"><span class="pre">compute_spectral_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/hrf.html#hrf.compute_spectral_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.hrf.hrf.compute_spectral_density" title="Link to this definition"></a></dt>
<dd><p>Compute the phonon spectral density with Gaussian broadening.</p>
<div class="math notranslate nohighlight">
\[S(\hbar \omega) = \sum_k S_k G(\hbar \omega, \hbar \omega_k, \sigma(\omega_k))\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is a normalized Gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy_axis</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>N</em><em>,</em><em>)</em>) – Energy axis in meV over which to evaluate the spectral density.</p></li>
<li><p><strong>sigma</strong> (<em>list</em><em> of </em><em>float</em>) – Two-element list <code class="docutils literal notranslate"><span class="pre">[sigma_0,</span> <span class="pre">sigma_1]</span></code> in meV, used for linewidth interpolation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>spectral_density</strong> – Spectral density evaluated on the given energy axis (in 1/meV).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray of shape (N,)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pypl.utils">
<span id="utils"></span><h2>Utils<a class="headerlink" href="#module-pypl.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pypl.utils.parse_atoms_qexml">
<span class="sig-prename descclassname"><span class="pre">pypl.utils.</span></span><span class="sig-name descname"><span class="pre">parse_atoms_qexml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/utils.html#parse_atoms_qexml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.utils.parse_atoms_qexml" title="Link to this definition"></a></dt>
<dd><p>Parse atomic structure information from a Quantum ESPRESSO XML output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fileName</strong> (<em>str</em>) – Path to the QE XML file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>atomic_symbols</strong> (<em>list of str</em>) – Atomic symbols for all atoms in the structure.</p></li>
<li><p><strong>atomic_positions</strong> (<em>ndarray of shape (N, 3)</em>) – Cartesian atomic coordinates in Ångström.</p></li>
<li><p><strong>cell_parameters</strong> (<em>ndarray of shape (3, 3)</em>) – Lattice vectors (cell parameters) in Ångström.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypl.utils.parse_forces_qexml">
<span class="sig-prename descclassname"><span class="pre">pypl.utils.</span></span><span class="sig-name descname"><span class="pre">parse_forces_qexml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/utils.html#parse_forces_qexml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.utils.parse_forces_qexml" title="Link to this definition"></a></dt>
<dd><p>Parse atomic forces from a Quantum ESPRESSO XML output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fileName</strong> (<em>str</em>) – Path to the QE XML file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>forces</strong> – Forces on atoms in eV/Å.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray of shape (N, 3)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the <cite>&lt;forces&gt;</cite> tag cannot be found in the XML file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypl.utils.parse_phonopy_h5">
<span class="sig-prename descclassname"><span class="pre">pypl.utils.</span></span><span class="sig-name descname"><span class="pre">parse_phonopy_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/utils.html#parse_phonopy_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.utils.parse_phonopy_h5" title="Link to this definition"></a></dt>
<dd><p>Parse phonon frequencies and eigenmodes from a Phonopy HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fileName</strong> (<em>str</em>) – Path to the Phonopy HDF5 file (e.g., <code class="docutils literal notranslate"><span class="pre">phonon.hdf5</span></code>).</p></li>
<li><p><strong>real_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance below which imaginary components of eigenmodes are discarded.
Default is <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>freqs</strong> (<em>ndarray of shape (M,)</em>) – Phonon frequencies in THz.</p></li>
<li><p><strong>modes</strong> (<em>ndarray of shape (M, Nat, 3)</em>) – Phonon eigenmodes. Converted to real if imaginary parts are negligible.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the imaginary part of eigenmodes exceeds <code class="docutils literal notranslate"><span class="pre">real_tol</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypl.utils.parse_phonopy_yaml">
<span class="sig-prename descclassname"><span class="pre">pypl.utils.</span></span><span class="sig-name descname"><span class="pre">parse_phonopy_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'band.yaml'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypl/utils.html#parse_phonopy_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypl.utils.parse_phonopy_yaml" title="Link to this definition"></a></dt>
<dd><p>Parse phonon frequencies and eigenmodes from a Phonopy <code class="docutils literal notranslate"><span class="pre">band.yaml</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fileName</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the <code class="docutils literal notranslate"><span class="pre">band.yaml</span></code> file. Default is <code class="docutils literal notranslate"><span class="pre">&quot;band.yaml&quot;</span></code>.</p></li>
<li><p><strong>real_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for discarding imaginary parts of eigenmodes.
Default is <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>freqs</strong> (<em>ndarray of shape (3N,)</em>) – Phonon frequencies in THz.</p></li>
<li><p><strong>modes</strong> (<em>ndarray of shape (3N, N, 3)</em>) – Phonon eigenmodes.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the imaginary component of any eigenvector exceeds <code class="docutils literal notranslate"><span class="pre">real_tol</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="acknowledge.html" class="btn btn-neutral float-right" title="Credits" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Yu Jin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>